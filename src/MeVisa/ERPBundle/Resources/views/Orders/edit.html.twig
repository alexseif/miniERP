{% extends ':default:admin.html.twig' %}
{% block title %}Edit Order {{ order.number }}{% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" type="text/css" href="/css/chosen.min.css" />
    <style type="text/css">
        .panel .form-group{ margin-bottom: 5px;}
        .panel-body{font-size: 11px;}
        .panel-body label{font-weight: 550}
        .panel .control-label{padding-left: 5px; padding-right: 5px;}
        .orderProducts li{margin-top: 5px;}
        .list-group-item{padding-top: 2px;padding-bottom: 2px}
        .badge{margin-top: 5px;}
        .table > tbody > tr > td, .table > tbody > tr > th, .table > tfoot > tr > td, .table > tfoot > tr > th, .table > thead > tr > td, .table > thead > tr > th {
            border-top: none;
            border-bottom: 1px solid #ddd;
            line-height: 1.42857;
            padding: 8px;
            vertical-align: middle;
        }
        .no-border > tbody > tr > td, .no-border > tbody > tr > th, .no-border > tfoot > tr > td, .no-border > tfoot > tr > th, .no-border > thead > tr > td, .no-border > thead > tr > th 
        {border: none;}
    </style>
{% endblock %}
{% block content %}
    {{ form_start(form) }}
    {{ form_row(form._token) }}
    {{ form_errors(form) }}
    <div class="panel panel-default">
        <div class="panel-heading clearfix">
            <span class="panel-title">Edit Order # {{ order.number }}</span>
            <div class="pull-right">
                <span class="label label-default">{{ order.channel|upper }}</span>
                &nbsp;<span class="label label-info">{{ order.stateName|upper }}</span>
                &nbsp;<span class="label label-default"> {{ order.createdAt|localizeddate }}</span>
            </div>
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-sm-6">
                    <!-- Order Customer-->
                    {% include 'MeVisaERPBundle:Orders:order_customer_form.html.twig' %}
                    <!-- Order Customer-->
                </div>
                <div class="col-sm-6">
                    <!-- Order Details -->
                    {% include 'MeVisaERPBundle:Orders:order_details_form.html.twig' %}
                    <!-- Order Details -->
                </div>
            </div>
            <!-- Order Products -->
            {% include 'MeVisaERPBundle:Orders:order_products_form.html.twig' %}
            <!-- Order Products -->
            <!-- Order Companions -->
            {% include 'MeVisaERPBundle:Orders:order_companions_form.html.twig' %}
            <!-- Order Companions -->
            <div class="row">
                <div class="col-sm-6">
                    <!-- Order Payments -->
                    {% include 'MeVisaERPBundle:Orders:order_payments_form.html.twig' %}
                    <!-- Order Payments -->
                </div>
                <div class="col-sm-6">
                    <!-- Order Documents -->
                    {% include 'MeVisaERPBundle:Orders:order_documents_form.html.twig' %}
                    <!-- Order Documents -->
                </div>
            </div><div class="row">
                <div class="col-sm-6">
                    <!-- Invoice -->
                    {% include 'MeVisaERPBundle:Orders:order_invoices_form.html.twig' %}
                    <!-- Invoice -->
                </div>
                <div class="col-sm-6">
                    <!-- Order Comments -->
                    {% include 'MeVisaERPBundle:Orders:order_comments_form.html.twig' %}
                    <!-- Order Comments -->
                </div>
            </div>
        </div>
        <!-- panel body -->
        <div class="panel-footer">
            <div class="row">
                {#FIXME: return to order show #}
                <div class="col-sm-2"><a class="btn btn-warning" href="{{ path('dashboard') }}">Cancel</a></div>
                <div class="col-sm-4">{{ form_row(form.total) }}</div>
                <div class="col-sm-4">
                    {# <div class="btn-toolbar pull-right">#}
                    {# {% for child in order.orderState.currentState.children %}
                         <button class="btn-{{child.bootstrapClass}} btn btn-toolbar" name="mevisa_erpbundle_orders[{{child.key}}]" id="mevisa_erpbundle_orders_{{child.key}}" type="submit">{{child.name}}</button>
                     {% endfor %}#}
                    {# <button class="btn-warning btn" name="mevisa_erpbundle_orders[submit]" id="mevisa_erpbundle_orders_submit" type="submit">DOCUMENT</button>#}
                    {# <button class="btn-primary btn" name="mevisa_erpbundle_orders[submit]" id="mevisa_erpbundle_orders_submit" type="submit">POST</button>#}
                    {#{{ form_widget(form.not_paid) }}
                    {{ form_widget(form.document) }}
                    {{ form_widget(form.post) }}#}
                    {# </div>#}
                    {{ form_row(form.state) }}
                </div>
                <div class="col-sm-2">{{ form_widget(form.update) }}</div>
            </div>
        </div>
    </div>
    {{ form_end(form, {'render_rest': false}) }}
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="/js/chosen.jquery.min.js"></script>
    <script type="text/javascript" src="/js/orders.js"></script>
    <script type="text/javascript">
        var productPrices = new Array();
        {% for price in productPrices %}
            productPrices[{{ price.product.id }}] = {{price.price/100}};
        {% endfor %}
    </script>
{% endblock %}